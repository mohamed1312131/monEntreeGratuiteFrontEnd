<section id="foires">
	<div class="container">
		<div class="row">
			<div class="inner-content">

				<div class="section-header text-center">
					<span class="section-subtitle">Nos √âv√©nements</span>
					<h2 class="section-title">Foires et Salons</h2>
				</div>

				<!-- Nav tabs -->
				<ul class="nav nav-tabs my-3 justify-content-center gap-3" id="foires-tab" role="tablist">
				  <li class="nav-item" role="presentation">
					<a href="#" class="nav-link active" id="nav-france-tab" data-bs-toggle="tab" data-bs-target="#nav-france" type="button" role="tab" aria-controls="france" aria-selected="true">
						<span class="flag-icon">üá´üá∑</span> France
					</a>
				  </li>
				  <li class="nav-item" role="presentation">
					<a href="#" class="nav-link" id="nav-belgium-tab" data-bs-toggle="tab" data-bs-target="#nav-belgium" type="button" role="tab" aria-controls="belgium" aria-selected="false">
						<span class="flag-icon">üáßüá™</span> Belgique
					</a>
				  </li>
				  <li class="nav-item" role="presentation">
					<a href="#" class="nav-link" id="nav-swiss-tab" data-bs-toggle="tab" data-bs-target="#nav-swiss" type="button" role="tab" aria-controls="swiss" aria-selected="false">
						<span class="flag-icon">üá®üá≠</span> Suisse
					</a>
				  </li>
				</ul>
				
				<!-- Tab panes -->
				<div class="tab-content">
				  <div class="tab-pane active" id="nav-france" role="tabpanel" aria-labelledby="nav-france-tab">
					<div *ngIf="isLoading" class="text-center py-5">
						<div class="spinner-border text-primary" role="status">
							<span class="visually-hidden">Chargement...</span>
						</div>
					</div>
					<div *ngIf="!isLoading && foiresFrance.length === 0" class="text-center py-5">
						<p class="text-muted">Aucune foire disponible pour le moment</p>
					</div>
					<div *ngIf="!isLoading && foiresFrance.length > 0" class="foires-carousel-container position-relative">
						<button class="carousel-nav-btn prev-btn" (click)="scrollCarousel('france', 'prev')">
							<i class="icon icon-arrow-left"></i>
						</button>
						<button class="carousel-nav-btn next-btn" (click)="scrollCarousel('france', 'next')">
							<i class="icon icon-arrow-right"></i>
						</button>
						<div class="foires-carousel" id="france-carousel">
					<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 flex-nowrap">
						
						<div class="col" *ngFor="let foire of foiresFrance">
							<figure class="portfolio-style">
								<img [src]="foire.image" [alt]="foire.name" class="img-fluid portfolio-item">
								<figcaption>
									<h5>{{ foire.name }}</h5>
									<p class="text-muted">{{ formatDate(foire.date) }}</p>
									<button class="btn btn-primary btn-sm reserve-btn" (click)="onReserve(foire, 'France', 'FR')">R√©server Maintenant</button>
								</figcaption>
							</figure>
						</div>

					</div>
						</div>
					</div>
				  </div>
				  <div class="tab-pane" id="nav-belgium" role="tabpanel" aria-labelledby="nav-belgium-tab">
					<div *ngIf="!isLoading && foiresBelgium.length === 0" class="text-center py-5">
						<p class="text-muted">Aucune foire disponible pour le moment</p>
					</div>
					<div *ngIf="!isLoading && foiresBelgium.length > 0" class="foires-carousel-container position-relative">
						<button class="carousel-nav-btn prev-btn" (click)="scrollCarousel('belgium', 'prev')">
							<i class="icon icon-arrow-left"></i>
						</button>
						<button class="carousel-nav-btn next-btn" (click)="scrollCarousel('belgium', 'next')">
							<i class="icon icon-arrow-right"></i>
						</button>
						<div class="foires-carousel" id="belgium-carousel">
					<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 flex-nowrap">
						
						<div class="col" *ngFor="let foire of foiresBelgium">
							<figure class="portfolio-style">
								<img [src]="foire.image" [alt]="foire.name" class="img-fluid portfolio-item">
								<figcaption>
									<h5>{{ foire.name }}</h5>
									<p class="text-muted">{{ formatDate(foire.date) }}</p>
									<button class="btn btn-primary btn-sm reserve-btn" (click)="onReserve(foire, 'Belgique', 'BE')">R√©server Maintenant</button>
								</figcaption>
							</figure>
						</div>

					</div>
						</div>
					</div>
				  </div>
				  <div class="tab-pane" id="nav-swiss" role="tabpanel" aria-labelledby="nav-swiss-tab">
					<div *ngIf="!isLoading && foiresSwitzerland.length === 0" class="text-center py-5">
						<p class="text-muted">Aucune foire disponible pour le moment</p>
					</div>
					<div *ngIf="!isLoading && foiresSwitzerland.length > 0" class="foires-carousel-container position-relative">
						<button class="carousel-nav-btn prev-btn" (click)="scrollCarousel('swiss', 'prev')">
							<i class="icon icon-arrow-left"></i>
						</button>
						<button class="carousel-nav-btn next-btn" (click)="scrollCarousel('swiss', 'next')">
							<i class="icon icon-arrow-right"></i>
						</button>
						<div class="foires-carousel" id="swiss-carousel">
					<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 flex-nowrap">

						<div class="col" *ngFor="let foire of foiresSwitzerland">
							<figure class="portfolio-style">
								<img [src]="foire.image" [alt]="foire.name" class="img-fluid portfolio-item">
								<figcaption>
									<h5>{{ foire.name }}</h5>
									<p class="text-muted">{{ formatDate(foire.date) }}</p>
									<button class="btn btn-primary btn-sm reserve-btn" (click)="onReserve(foire, 'Suisse', 'CH')">R√©server Maintenant</button>
								</figcaption>
							</figure>
						</div>

					</div>
						</div>
					</div>
				  </div>
				</div>

			</div><!--inner-content-->
		</div>
	</div>
</section>

<!-- Reservation Side Form -->
<div class="reservation-overlay" [class.open]="isFormOpen" (click)="closeForm()"></div>
<div class="reservation-form-container" [class.open]="isFormOpen">
	<div class="form-header">
		<button class="close-btn" (click)="closeForm()">
			<i class="icon icon-close">√ó</i>
		</button>
	</div>

	<div class="form-content" *ngIf="selectedFoire">
		<!-- Foire Details Section -->
		<div class="foire-details">
			<img [src]="selectedFoire.image" [alt]="selectedFoire.name" class="foire-image">
			<div class="foire-info">
				<h3>{{ selectedFoire.name }}</h3>
				<p class="foire-date"><i class="icon icon-calendar"></i> {{ selectedFoire.date }}</p>
				<p class="foire-location"><i class="icon icon-location"></i> {{ selectedFoire.pays }}</p>
			</div>
		</div>

		<!-- Reservation Form -->
		<form class="reservation-form" (ngSubmit)="submitReservation()">
			<h4> R√©servez votre entr√©e gratuite</h4>
			
			<!-- Error Message -->
			<div *ngIf="errorMessage" class="alert alert-danger" role="alert">
				<strong>Erreur:</strong> {{ errorMessage }}
			</div>
			
			<!-- Success Message -->
			<div *ngIf="successMessage" class="alert alert-success" role="alert">
				<strong>Succ√®s!</strong> {{ successMessage }}
			</div>

			<!-- Pays -->
			<div class="form-group">
				<label for="pays">Pays *</label>
				<select id="pays" [(ngModel)]="reservationForm.pays" name="pays" required class="form-control">
					<option value="">S√©lectionnez un pays</option>
					<option value="France">France</option>
					<option value="Belgique">Belgique</option>
					<option value="Suisse">Suisse</option>
				</select>
			</div>

			<!-- Type d'entr√©e -->
			<div class="form-group">
				<label for="entreeType">Je souhaite une entr√©e pour *</label>
				<select id="entreeType" [(ngModel)]="reservationForm.entreeType" name="entreeType" required class="form-control">
					<option value="">S√©lectionnez</option>
					<option value="couple">Couple</option>
					<option value="moi-et-ami">Moi et mon ami(e)</option>
					<option value="moi-seulement">Moi seulement</option>
				</select>
			</div>

			<!-- Ville -->
			<div class="form-group">
				<label for="ville">Ville *</label>
				<input type="text" id="ville" [(ngModel)]="reservationForm.ville" name="ville" required class="form-control" placeholder="Votre ville">
			</div>

			<!-- Nom et Pr√©nom -->
			<div class="form-row">
				<div class="form-group">
					<label for="nom">Nom *</label>
					<input type="text" id="nom" [(ngModel)]="reservationForm.nom" name="nom" required class="form-control" placeholder="Nom">
				</div>
				<div class="form-group">
					<label for="prenom">Pr√©nom *</label>
					<input type="text" id="prenom" [(ngModel)]="reservationForm.prenom" name="prenom" required class="form-control" placeholder="Pr√©nom">
				</div>
			</div>

			<!-- SMS Number -->
			<div class="form-group">
				<label for="smsNumber">Je veux recevoir mon invitation par SMS sur le num√©ro</label>
				<input type="tel" id="smsNumber" [(ngModel)]="reservationForm.smsNumber" name="smsNumber" class="form-control" placeholder="+33 6 12 34 56 78">
			</div>

			<!-- Email -->
			<div class="form-group">
				<label for="email">Je veux recevoir mon invitation par email √† l'adresse *</label>
				<input type="email" id="email" [(ngModel)]="reservationForm.email" name="email" required class="form-control" placeholder="votre@email.com">
			</div>

			<!-- Tranche d'√¢ge -->
			<div class="form-group">
				<label for="trancheAge">Tranche d'√¢ge *</label>
				<select id="trancheAge" [(ngModel)]="reservationForm.trancheAge" name="trancheAge" required class="form-control">
					<option value="">S√©lectionnez votre tranche d'√¢ge</option>
					<option value="moins-35">Moins de 35 ans</option>
					<option value="35-70">Entre 35 et 70 ans</option>
					<option value="plus-70">Plus de 70 ans</option>
				</select>
			</div>

			<!-- T√©l√©phone -->
			<div class="form-group">
				<label for="telephone">Num√©ro de t√©l√©phone sur lequel vous √™tes joignable *</label>
				<input type="tel" id="telephone" [(ngModel)]="reservationForm.telephone" name="telephone" required class="form-control" placeholder="+33 6 12 34 56 78">
			</div>

			<!-- Conditions g√©n√©rales -->
			<div class="form-group checkbox-group">
				<label class="checkbox-label">
					<input type="checkbox" [(ngModel)]="reservationForm.acceptConditions" name="acceptConditions" required>
					<span class="checkbox-text">
						Je reconnais avoir lu et accept√© les <a href="#" target="_blank">conditions g√©n√©rales de services et d'utilisation</a> *
					</span>
				</label>
			</div>

			<!-- Marketing consent -->
			<div class="form-group checkbox-group">
				<label class="checkbox-label">
					<input type="checkbox" [(ngModel)]="reservationForm.acceptMarketing" name="acceptMarketing">
					<span class="checkbox-text">
						En cochant cette case, j'autorise VIPLUX d√©tenteur de monentreegratuite, √† utiliser mon email et/ou mon t√©l√©phone pour m'adresser mon invitation, des offres, actualit√©s et relances li√©es √† ses offres. Je peux retirer mon consentement √† tout moment via le lien de d√©sinscription (emails) ou en r√©pondant STOP (SMS).
					</span>
				</label>
			</div>

			<!-- Submit Button -->
			<button type="submit" class="btn-submit" [disabled]="!reservationForm.acceptConditions || isSubmitting">
				<span *ngIf="!isSubmitting">Confirmer ma r√©servation</span>
				<span *ngIf="isSubmitting">
					<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
					Envoi en cours...
				</span>
			</button>
		</form>
	</div>
</div>
