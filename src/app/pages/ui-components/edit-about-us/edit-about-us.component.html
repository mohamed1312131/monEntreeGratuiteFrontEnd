<div class="dialog-container">
  <div class="dialog-header">
    <h2 mat-dialog-title>Modifier la section "À Propos"</h2>
    <button mat-icon-button (click)="onCancel()" class="close-btn">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <mat-dialog-content class="dialog-content">
    <form class="edit-form">
      <!-- Title -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Titre</mat-label>
        <input matInput [(ngModel)]="aboutUs.title" name="title" required placeholder="Titre de la section" />
      </mat-form-field>

      <!-- Description -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description</mat-label>
        <textarea matInput [(ngModel)]="aboutUs.description" name="description" rows="5" placeholder="Description détaillée (optionnel)"></textarea>
      </mat-form-field>

      <!-- Q&A Section -->
      <div class="qa-section">
        <h3 class="section-title">Questions et Réponses</h3>
        
        <!-- Add Q&A Form -->
        <div class="qa-form">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Question</mat-label>
            <input matInput [(ngModel)]="newQuestion" name="newQuestion" placeholder="Entrez une question" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Réponse</mat-label>
            <textarea matInput [(ngModel)]="newResponse" name="newResponse" rows="3" placeholder="Entrez la réponse"></textarea>
          </mat-form-field>

          <button mat-raised-button color="accent" (click)="addQA()" type="button" class="add-qa-btn">
            <mat-icon>add</mat-icon>
            Ajouter Q&A
          </button>
        </div>

        <!-- Q&A List -->
        <div class="qa-list" *ngIf="aboutUs.qaList && aboutUs.qaList.length > 0">
          <div class="qa-item" *ngFor="let qa of aboutUs.qaList; let i = index">
            <div class="qa-content">
              <div class="qa-question">
                <strong>Q:</strong> {{ qa.question }}
              </div>
              <div class="qa-response">
                <strong>R:</strong> {{ qa.response }}
              </div>
            </div>
            <div class="qa-actions">
              <button mat-icon-button (click)="moveQAUp(i)" [disabled]="i === 0" matTooltip="Monter">
                <mat-icon>arrow_upward</mat-icon>
              </button>
              <button mat-icon-button (click)="moveQADown(i)" [disabled]="i === aboutUs.qaList!.length - 1" matTooltip="Descendre">
                <mat-icon>arrow_downward</mat-icon>
              </button>
              <button mat-icon-button color="warn" (click)="removeQA(i)" matTooltip="Supprimer">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Video Section -->
      <div class="video-section">
        <h3 class="section-title">Vidéo</h3>
        
        <!-- YouTube Link -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Lien YouTube</mat-label>
          <input matInput [(ngModel)]="aboutUs.videoUrl" name="videoUrl" placeholder="https://www.youtube.com/watch?v=..." (ngModelChange)="onVideoUrlChange()" />
          <mat-icon matSuffix>link</mat-icon>
        </mat-form-field>

        <div class="divider-text">
          <span>OU</span>
        </div>

        <!-- Video Upload -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Télécharger une vidéo</mat-label>
          <input matInput [(ngModel)]="videoFileName" name="videoDisplay" [value]="videoFileName" readonly placeholder="Choisir une vidéo..." />
          <button mat-icon-button matSuffix (click)="videoFileInput.click()" type="button" [disabled]="isUploading">
            <mat-icon *ngIf="!isUploading">upload</mat-icon>
            <mat-icon *ngIf="isUploading" class="spinning">hourglass_empty</mat-icon>
          </button>
        </mat-form-field>
        <input #videoFileInput type="file" accept="video/*" (change)="onVideoChange($event)" hidden />

        <!-- Current Video Preview -->
        <div class="video-preview" *ngIf="aboutUs.videoUrl && !isUploading">
          <p class="preview-label">Vidéo actuelle:</p>
          <a [href]="aboutUs.videoUrl" target="_blank" class="video-link">
            <mat-icon>play_circle</mat-icon>
            Voir la vidéo
          </a>
        </div>
      </div>

      <!-- Active Status -->
      <div class="status-toggle">
        <mat-slide-toggle [(ngModel)]="aboutUs.isActive" name="isActive" color="primary">
          Section active
        </mat-slide-toggle>
      </div>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions class="dialog-actions">
    <button mat-stroked-button (click)="onCancel()" [disabled]="isUploading">
      Annuler
    </button>
    <button mat-raised-button color="primary" (click)="onSave()" [disabled]="isUploading">
      <mat-icon *ngIf="!isUploading">save</mat-icon>
      <mat-icon *ngIf="isUploading" class="spinning">hourglass_empty</mat-icon>
      <span *ngIf="!isUploading">Enregistrer</span>
      <span *ngIf="isUploading">Enregistrement...</span>
    </button>
  </mat-dialog-actions>
</div>
